"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,a,r){return a&&e(t.prototype,a),r&&e(t,r),t}}(),ShareableCanvas=function(){function e(t){var a=this;_classCallCheck(this,e),this.initialized=!0,this.changed=!1,this.container=t.container,this.canvas=document.getElementById(t.container),this.fingers=[],this.stage=new createjs.Stage(this.container),this.stage.addEventListener("mousedown",function(e){return a.stageMouseDown(e)}),this.stage.addEventListener("pressmove",function(e){return a.stagePressMove(e)}),this.stage.addEventListener("pressup",function(e){return a.stagePressUp(e)}),createjs.Touch.enable(this.stage)}return _createClass(e,[{key:"stageMouseDown",value:function(e){this.fingers[e.pointerID]={start:{x:e.stageX,y:e.stageY},current:{x:e.stageX,y:e.stageY},old:{x:e.stageX,y:e.stageY}},this.calculateActiveFingers(),this.stage.dispatchEvent("start")}},{key:"stagePressMove",value:function(e){var t=e.pointerID;this.fingers[t].current.x=e.stageX,this.fingers[t].current.y=e.stageY,void 0!==e.localX&&(this.fingers[t].local={x:null,y:null},this.fingers[t].local.x=e.localX,this.fingers[t].local.y=e.localY),this.calculateActiveFingers(),this.changed=!0,this.update()}},{key:"stagePressUp",value:function(e){this.fingers[e.pointerID]&&delete this.fingers[e.pointerID],this.calculateActiveFingers(),this.stage.dispatchEvent("complete"),this.update()}},{key:"enterFrame",value:function(e){if(this.stage.dispatchEvent("update"),this.changed){this.changed=!1;for(var t in self.fingers)self.fingers[t].start&&(self.fingers[t].old.x=self.fingers[t].current.x,self.fingers[t].old.y=self.fingers[t].current.y)}}},{key:"calculateActiveFingers",value:function(){this.activeFingers=0;for(var e in this.fingers)this.fingers[e].start&&this.activeFingers++}},{key:"update",value:function(e){this.stage.update()}},{key:"transform",value:function(e){if(this.activeFingers>1){var t=[];for(var a in this.fingers)if(this.fingers[a].current&&(t.push(this.fingers[a]),t.length>=2))break;var r=t[0].old,n=t[1].old,s=Math.atan2(r.y-n.y,r.x-n.x)*(180/Math.PI);r=t[0].current,n=t[1].current;var i=Math.atan2(r.y-n.y,r.x-n.x)*(180/Math.PI),c=i-s;e.currentTarget.rotation+=.02*c,this.stage.dispatchEvent("rotate");var u=this.getDistance(t[0].current,t[1].current)/this.getDistance(t[0].old,t[1].old);if(u>1.01||.9>u){u=1-u;var l=e.currentTarget.scaleX*u*-.02;e.currentTarget.scaleX+=l,e.currentTarget.scaleY=e.currentTarget.scaleX,this.stage.dispatchEvent("scale")}}var g={x:0,y:0};for(var o in this.fingers)this.fingers[o].start&&(g.x+=this.fingers[o].current.x-this.fingers[o].old.x,g.y+=this.fingers[o].current.y-this.fingers[o].old.y);g.x/=Math.max(1,this.activeFingers),g.y/=Math.max(1,this.activeFingers),e.currentTarget.x=e.currentTarget.localX+g.x,e.currentTarget.y=e.currentTarget.localY+g.y,this.stage.dispatchEvent("move")}},{key:"savePosition",value:function(e){e.currentTarget.localX=e.currentTarget.x,e.currentTarget.localY=e.currentTarget.y}},{key:"drawCircle",value:function(){var e=new createjs.Shape;e.graphics.beginFill("DeepSkyBlue").drawCircle(0,0,50),e.x=100,e.y=100,this.stage.addChild(e),this.update()}},{key:"loadImage",value:function(e){var t=this,a=new Image;a.src=e,a.onload=function(e){var a=e.target;t.addImage(a)}}},{key:"addImage",value:function(e){var t=this,a=new createjs.Bitmap(e),r=a.getBounds();a.regX=r.width/2,a.regY=r.height/2,a.addEventListener("mousedown",function(e){return t.savePosition(e)}),a.addEventListener("pressmove",function(e){return t.transform(e)}),this.stage.addChild(a),this.update()}},{key:"getDistance",value:function(e,t){var a=t.x-e.x,r=t.y-e.y;return Math.sqrt(a*a+r*r)}},{key:"getMidPoint",value:function(e,t){var a={x:null,y:null};return a.x=e.x+t.x/2,a.y=e.y+t.y/2,a}}]),e}();
//# sourceMappingURL=admin/js/shareable-canvas.min.js.map
