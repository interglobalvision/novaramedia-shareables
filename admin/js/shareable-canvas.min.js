"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),ShareableCanvas=function(){function e(t){var a=this;_classCallCheck(this,e),this.initialized=!0,this.changed=!1,this.container=t.container,this.canvas=document.getElementById(t.container),this.fingers=[],this.stage=new createjs.Stage(this.container),this.stage.addEventListener("mousedown",function(e){return a.stageMouseDown(e)}),this.stage.addEventListener("pressmove",function(e){return a.stagePressMove(e)}),this.stage.addEventListener("pressup",function(e){return a.stagePressUp(e)}),createjs.Touch.enable(this.stage)}return _createClass(e,[{key:"stageMouseDown",value:function(e){this.fingers[e.pointerID]={start:{x:e.stageX,y:e.stageY},current:{x:e.stageX,y:e.stageY},old:{x:e.stageX,y:e.stageY}},this.calculateActiveFingers(),this.stage.dispatchEvent("start")}},{key:"stagePressMove",value:function(e){var t=e.pointerID;this.fingers[t].current.x=e.stageX,this.fingers[t].current.y=e.stageY,void 0!==e.localX&&(this.fingers[t].local={x:null,y:null},this.fingers[t].local.x=e.localX,this.fingers[t].local.y=e.localY),this.calculateActiveFingers(),this.changed=!0,this.update()}},{key:"stagePressUp",value:function(e){this.fingers[e.pointerID]&&delete this.fingers[e.pointerID],this.calculateActiveFingers(),this.stage.dispatchEvent("complete"),this.update()}},{key:"enterFrame",value:function(e){if(this.stage.dispatchEvent("update"),this.changed){this.changed=!1;for(var t in self.fingers)self.fingers[t].start&&(self.fingers[t].old.x=self.fingers[t].current.x,self.fingers[t].old.y=self.fingers[t].current.y)}}},{key:"calculateActiveFingers",value:function(){this.activeFingers=0;for(var e in this.fingers)this.fingers[e].start&&this.activeFingers++}},{key:"update",value:function(e){this.stage.update()}},{key:"transform",value:function(e){if(this.activeFingers>1){var t=[];for(var a in this.fingers)if(this.fingers[a].current&&(t.push(this.fingers[a]),t.length>=2))break;var n=t[0].old,i=t[1].old,s=Math.atan2(n.y-i.y,n.x-i.x)*(180/Math.PI);n=t[0].current,i=t[1].current;var r=Math.atan2(n.y-i.y,n.x-i.x)*(180/Math.PI),c=r-s;e.currentTarget.rotation+=.02*c,this.stage.dispatchEvent("rotate");var l=this.getDistance(t[0].current,t[1].current)/this.getDistance(t[0].old,t[1].old);if(l>1.01||.9>l){l=1-l;var u=e.currentTarget.scaleX*l*-.02;e.currentTarget.scaleX+=u,e.currentTarget.scaleY=e.currentTarget.scaleX,this.stage.dispatchEvent("scale")}}var h={x:0,y:0};for(var o in this.fingers)this.fingers[o].start&&(h.x+=this.fingers[o].current.x-this.fingers[o].old.x,h.y+=this.fingers[o].current.y-this.fingers[o].old.y);h.x/=Math.max(1,this.activeFingers),h.y/=Math.max(1,this.activeFingers),e.currentTarget.x=e.currentTarget.localX+h.x,e.currentTarget.y=e.currentTarget.localY+h.y,this.stage.dispatchEvent("move")}},{key:"savePosition",value:function(e){e.currentTarget.localX=e.currentTarget.x,e.currentTarget.localY=e.currentTarget.y}},{key:"drawCircle",value:function(){var e=new createjs.Shape;e.graphics.beginFill("DeepSkyBlue").drawCircle(0,0,50),e.x=100,e.y=100,this.stage.addChild(e),this.update()}},{key:"drawBackground",value:function(){var e=new createjs.Shape;e.graphics.beginFill("Black").drawRect(0,0,this.canvas.width,this.canvas.width),this.stage.addChild(e),this.update()}},{key:"loadImage",value:function(e,t){var a=this,n=new Image;n.src=e,n.onload=function(e,t){var n=e.target;a.addImage(n)}}},{key:"addImage",value:function(e){var t=this,a=new createjs.Bitmap(e);a.alpha=.3;var n=a.getBounds(),i=this.canvas.height/n.height;a.scaleY=i,a.scaleX=i,a.addEventListener("mousedown",function(e){return t.savePosition(e)}),a.addEventListener("pressmove",function(e){return t.transform(e)}),this.stage.addChild(a),this.update()}},{key:"getDistance",value:function(e,t){var a=t.x-e.x,n=t.y-e.y;return Math.sqrt(a*a+n*n)}},{key:"getMidPoint",value:function(e,t){var a={x:null,y:null};return a.x=e.x+t.x/2,a.y=e.y+t.y/2,a}},{key:"addQuote",value:function(e){var t=this,a=new createjs.Text("								"+e,"29px Georgia","#ffffff");a.textBaseline="alphabetic",a.x=50,a.y=100,a.lineWidth=900,a.lineHeight=50,a.addEventListener("mousedown",function(e){return t.savePosition(e)}),a.addEventListener("pressmove",function(e){return t.transform(e)}),this.stage.addChild(a),this.update()}},{key:"addTitle",value:function(e){var t=new createjs.Text(e,"20px Georgia","#ffffff");t.textBaseline="alphabetic",t.x=200,t.y=520,t.lineWidth=750,t.lineHeight=30,this.stage.addChild(t),this.update()}},{key:"addUrl",value:function(e){var t=new createjs.Text(e,"14px Georgia","#ffffff");t.textBaseline="alphabetic",t.x=200,t.y=550,t.lineWidth=750,t.lineHeight=30,this.stage.addChild(t),this.update()}},{key:"addLogo",value:function(){var e=this,t=new Image;t.src=ShareableVars.pluginurl+"/admin/img/nm-white-logo.svg",t.onload=function(t,a){var n=t.target,i=new createjs.Bitmap(n);i.setTransform(50,485,.11,.11,-3.15),e.stage.addChild(i),e.update()}}}]),e}();
//# sourceMappingURL=admin/js/shareable-canvas.min.js.map
