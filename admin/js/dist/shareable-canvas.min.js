"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var a=0;a<t.length;a++){var i=t[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,a,i){return a&&e(t.prototype,a),i&&e(t,i),t}}(),ShareableCanvas=function(){function e(t){var a=this;_classCallCheck(this,e),this.initialized=!0,this.changed=!1,this.container=t.container,this.canvas=document.getElementById(t.container),this.fingers=[],this.stage=new createjs.Stage(this.container),this.stage.addEventListener("mousedown",function(e){return a.stageMouseDown(e)}),this.stage.addEventListener("pressmove",function(e){return a.stagePressMove(e)}),this.stage.addEventListener("pressup",function(e){return a.stagePressUp(e)}),createjs.Touch.enable(this.stage)}return _createClass(e,[{key:"stageMouseDown",value:function(e){this.fingers[e.pointerID]={start:{x:e.stageX,y:e.stageY},current:{x:e.stageX,y:e.stageY},old:{x:e.stageX,y:e.stageY}},this.calculateActiveFingers(),this.stage.dispatchEvent("start")}},{key:"stagePressMove",value:function(e){var t=e.pointerID;this.fingers[t].current.x=e.stageX,this.fingers[t].current.y=e.stageY,void 0!==e.localX&&(this.fingers[t].local={x:null,y:null},this.fingers[t].local.x=e.localX,this.fingers[t].local.y=e.localY),this.calculateActiveFingers(),this.changed=!0,this.update()}},{key:"stagePressUp",value:function(e){this.fingers[e.pointerID]&&delete this.fingers[e.pointerID],this.calculateActiveFingers(),this.stage.dispatchEvent("complete"),this.update()}},{key:"enterFrame",value:function(e){if(this.stage.dispatchEvent("update"),this.changed){this.changed=!1;for(var t in self.fingers)self.fingers[t].start&&(self.fingers[t].old.x=self.fingers[t].current.x,self.fingers[t].old.y=self.fingers[t].current.y)}}},{key:"calculateActiveFingers",value:function(){this.activeFingers=0;for(var e in this.fingers)this.fingers[e].start&&this.activeFingers++}},{key:"update",value:function(e){this.stage.update()}},{key:"transform",value:function(e){if(this.activeFingers>1){var t=[];for(var a in this.fingers)if(this.fingers[a].current&&(t.push(this.fingers[a]),t.length>=2))break;var i=t[0].old,n=t[1].old,s=Math.atan2(i.y-n.y,i.x-n.x)*(180/Math.PI);i=t[0].current,n=t[1].current;var r=Math.atan2(i.y-n.y,i.x-n.x)*(180/Math.PI),c=r-s;e.currentTarget.rotation+=.02*c,this.stage.dispatchEvent("rotate");var l=this.getDistance(t[0].current,t[1].current)/this.getDistance(t[0].old,t[1].old);if(l>1.01||l<.9){l=1-l;var h=e.currentTarget.scaleX*l*-.02;e.currentTarget.scaleX+=h,e.currentTarget.scaleY=e.currentTarget.scaleX,this.stage.dispatchEvent("scale")}}var u={x:0,y:0};for(var g in this.fingers)this.fingers[g].start&&(u.x+=this.fingers[g].current.x-this.fingers[g].old.x,u.y+=this.fingers[g].current.y-this.fingers[g].old.y);u.x/=Math.max(1,this.activeFingers),u.y/=Math.max(1,this.activeFingers),e.currentTarget.x=e.currentTarget.localX+u.x,e.currentTarget.y=e.currentTarget.localY+u.y,this.stage.dispatchEvent("move")}},{key:"savePosition",value:function(e){e.currentTarget.localX=e.currentTarget.x,e.currentTarget.localY=e.currentTarget.y}},{key:"drawCircle",value:function(){var e=new createjs.Shape;e.graphics.beginFill("DeepSkyBlue").drawCircle(0,0,50),e.x=100,e.y=100,this.stage.addChild(e),this.update()}},{key:"drawBackground",value:function(){var e=new createjs.Shape;e.graphics.beginFill("Black").drawRect(0,0,this.canvas.width,this.canvas.width),this.stage.addChild(e),this.update()}},{key:"loadImage",value:function(e,t){var a=this,i=new Image;i.src=e,i.onload=function(e,t){var i=e.target;a.addImage(i)}}},{key:"addImage",value:function(e){var t=this,a=new createjs.Bitmap(e);a.alpha=.3;var i=a.getBounds(),n=i.height/i.width;if(n>.5225)var s=this.canvas.width/i.width;else var s=this.canvas.height/i.height;a.scaleY=s,a.scaleX=s,a.addEventListener("mousedown",function(e){return t.savePosition(e)}),a.addEventListener("pressmove",function(e){return t.transform(e)}),this.stage.addChild(a),this.update()}},{key:"getDistance",value:function(e,t){var a=t.x-e.x,i=t.y-e.y;return Math.sqrt(a*a+i*i)}},{key:"getMidPoint",value:function(e,t){var a={x:null,y:null};return a.x=e.x+t.x/2,a.y=e.y+t.y/2,a}},{key:"addQuote",value:function(e,t,a){var i=void 0;i=a?"\t\t\t\t\t“"+e+"”":"\t\t\t\t\t"+e;var n=new createjs.Text(i,t+"px Georgia","#ffffff");n.textBaseline="alphabetic",n.x=50,n.y=100,n.lineWidth=1100,n.lineHeight=1.7*t,this.stage.addChild(n),this.update()}},{key:"addTitle",value:function(e){var t=new createjs.Text(e,"23px Georgia","#ffffff");t.textBaseline="alphabetic",t.x=200,t.y=537,t.lineWidth=1e3,t.lineHeight=30,this.stage.addChild(t),this.update()}},{key:"addUrl",value:function(e){var t=new createjs.Text(e,"14px Georgia","#ffffff");t.textBaseline="alphabetic",t.x=200,t.y=572,t.lineWidth=1e3,t.lineHeight=30,this.stage.addChild(t),this.update()}},{key:"addLogo",value:function(){var e=this,t=new Image;t.src=ShareableVars.pluginurl+"/admin/img/nm-white-logo.svg",t.onload=function(t,a){var i=t.target,n=new createjs.Bitmap(i);n.setTransform(50,507,.11,.11,-3.15),e.stage.addChild(n),e.update()}}}]),e}();
//# sourceMappingURL=sourcemaps/shareable-canvas.js.map
